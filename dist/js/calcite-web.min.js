/* calcite-web - v1.0.0-beta - 2015-12-14
*  https://github.com/esri/calcite-web
*  Copyright (c) 2015 Environmental Systems Research Institute, Inc.
*  Apache 2.0 License */
!function(){function click(){return"click"}function addEvent(domNode,e,fn){return domNode.addEventListener?domNode.addEventListener(e,fn,!1):domNode.attachEvent?domNode.attachEvent("on"+e,fn):void 0}function removeEvent(domNode,e,fn){return domNode.removeEventListener?domNode.removeEventListener(e,fn,!1):domNode.detachEvent?domNode.detachEvent("on"+e,fn):void 0}function eventTarget(e){return e.target||e.srcElement}function preventDefault(e){return e.preventDefault?e.preventDefault():void(e.returnValue&&(e.returnValue=!1))}function stopPropagation(e){return e=e||window.event,e.stopPropagation?e.stopPropagation():void(e.cancelBubble&&(e.cancelBubble=!0))}function throttle(fn,time,context){var lock,args,wrapperFn,later;return later=function(){lock=!1,args&&(wrapperFn.apply(context,args),args=!1)},wrapperFn=function(){lock?args=arguments:(fn.apply(context,arguments),setTimeout(later,time),lock=!0)}}function hasClass(domNode,className){var elementClass=" "+domNode.className+" ";return-1!==elementClass.indexOf(" "+className+" ")}function addClass(domNode,classes){classes.split(" ").forEach(function(c){hasClass(domNode,c)||(domNode.className+=" "+c)})}function removeClass(domNode,classes){var elementClass=" "+domNode.className+" ";classes.split(" ").forEach(function(c){elementClass=elementClass.replace(" "+c+" "," ")}),domNode.className=elementClass.trim()}function toggleClass(domNode,className){hasClass(domNode,className)?removeClass(domNode,className):addClass(domNode,className)}function closest(className,context){var result,current;for(current=context;current;current=current.parentNode)if(1===current.nodeType&&hasClass(current,className)){result=current;break}return current}function nodeListToArray(domNodeList){return Array.prototype.slice.call(domNodeList)}function findElements(query,domNode){var context=domNode||document,elements=context.querySelectorAll(query);return nodeListToArray(elements)}function removeActive(array){"object"==typeof array&&(array=nodeListToArray(array)),array.forEach(function(item){removeClass(item,"is-active")})}function toggleActive(array,el){var isActive=hasClass(el,"is-active");isActive?removeClass(el,"is-active"):(removeActive(array),addClass(el,"is-active"))}function toggleAriaHidden(array){array.forEach(function(node){var hidden=node.getAttribute("aria-hidden");"true"!==hidden?node.setAttribute("aria-hidden",!0):node.removeAttribute("aria-hidden")})}function init(patterns){patterns=patterns||["sticky","accordion","dropdown","drawer","expandingNav","modal","tabs","siteSearch","thirdNav"],patterns.forEach(function(pattern){calcite[pattern]()})}var calcite={version:"v1.0.0-beta",click:click,addEvent:addEvent,removeEvent:removeEvent,eventTarget:eventTarget,preventDefault:preventDefault,stopPropagation:stopPropagation,hasClass:hasClass,addClass:addClass,removeClass:removeClass,toggleClass:toggleClass,closest:closest,nodeListToArray:nodeListToArray,init:init};if(String.prototype.includes||(String.prototype.includes=function(){"use strict";return-1!==String.prototype.indexOf.apply(this,arguments)}),!function(){function addPolyfill(e){var type="focus"===e.type?"focusin":"focusout",event=new CustomEvent(type,{bubbles:!0,cancelable:!1});event.c1Generated=!0,e.target.dispatchEvent(event)}function removePolyfill(e){e.c1Generated||(d.removeEventListener("focus",addPolyfill,!0),d.removeEventListener("blur",addPolyfill,!0),d.removeEventListener("focusin",removePolyfill,!0),d.removeEventListener("focusout",removePolyfill,!0)),setTimeout(function(){d.removeEventListener("focusin",removePolyfill,!0),d.removeEventListener("focusout",removePolyfill,!0)})}var w=window,d=w.document;void 0===w.onfocusin&&(d.addEventListener("focus",addPolyfill,!0),d.addEventListener("blur",addPolyfill,!0),d.addEventListener("focusin",removePolyfill,!0),d.addEventListener("focusout",removePolyfill,!0))}(),calcite.accordion=function(domNode){function toggleAriaExpanded(domNode){domNode.getAttribute("aria-expanded");domNode.getAttribute("aria-expanded")?domNode.setAttribute("aria-expanded","false"):domNode.setAttribute("aria-expanded","true")}function toggleAccordion(e){var parent=closest("accordion-section",eventTarget(e));toggleClass(parent,"is-active"),toggleAriaExpanded(parent)}findElements(".js-accordion",domNode).forEach(function(accordion){accordion.setAttribute("aria-live","polite"),accordion.setAttribute("role","tablist"),nodeListToArray(accordion.children).forEach(function(child){var firstChild=child.children[0];firstChild.setAttribute("role","tab"),firstChild.setAttribute("tabindex","0"),hasClass(child,"is-active")?child.setAttribute("aria-expanded","true"):child.setAttribute("aria-expanded","false");var sectionTitle=child.querySelector(".accordion-title");addEvent(sectionTitle,click(),toggleAccordion),addEvent(child,"keyup",function(e){13===e.keyCode&&toggleAccordion(e)})})})},calcite.dropdown=function(domNode){function closeAllDropdowns(){removeEvent(document.body,click(),closeAllDropdowns),dropdowns.forEach(function(dropdown){removeClass(dropdown,"is-active")})}function bindToggle(toggle){addEvent(toggle,click(),function(e){preventDefault(e),stopPropagation(e);var dropdown=closest("js-dropdown",toggle),isOpen=hasClass(dropdown,"is-active");closeAllDropdowns(),isOpen||addClass(dropdown,"is-active"),addEvent(document.body,click(),closeAllDropdowns)})}var toggles=findElements(".js-dropdown-toggle",domNode),dropdowns=findElements(".js-dropdown",domNode);toggles.forEach(bindToggle)},calcite.drawer=function(domNode){function fenceDrawer(e){closest("js-drawer",e.target)||drawers.forEach(function(drawer){hasClass(drawer,"is-active")&&drawer.focus()})}function escapeCloseDrawer(e){27===e.keyCode&&(drawers.forEach(function(drawer){removeClass(drawer,"is-active"),drawer.removeAttribute("tabindex")}),toggleAriaHidden([wrapper,footer]),removeEvent(document,"keyup",escapeCloseDrawer),removeEvent(document,"focusin",fenceDrawer),lastOn.focus())}function bindDrawerToggle(e){preventDefault(e);var toggle=e.target,drawerId=toggle.getAttribute("data-drawer"),drawer=document.querySelector('.js-drawer[data-drawer="'+drawerId+'"]'),isOpen=hasClass(drawer,"is-active");toggleActive(drawers,drawer),toggleAriaHidden([wrapper,footer]),isOpen?(removeEvent(document,"keyup",escapeCloseDrawer),removeEvent(document,"focusin",fenceDrawer),lastOn.focus(),drawer.removeAttribute("tabindex")):(addEvent(document,"keyup",escapeCloseDrawer),addEvent(document,"focusin",fenceDrawer),lastOn=toggle,drawer.setAttribute("tabindex",0),drawer.focus())}var lastOn,wrapper=document.querySelector(".wrapper"),footer=document.querySelector(".footer"),toggles=findElements(".js-drawer-toggle",domNode),drawers=findElements(".js-drawer",domNode);toggles.forEach(function(toggle){addEvent(toggle,click(),bindDrawerToggle)}),drawers.forEach(function(drawer){addEvent(drawer,click(),function(e){hasClass(eventTarget(e),"drawer")&&(toggleActive(drawers,drawer),toggleAriaHidden([wrapper,footer]),removeEvent(document,"keyup",escapeCloseDrawer))})})},calcite.expandingNav=function(domNode){var toggles=findElements(".js-expand-toggle",domNode),sections=document.querySelectorAll(".js-expand");toggles.forEach(function(toggle){addEvent(toggle,click(),function(e){preventDefault(e);var sectionId=toggle.getAttribute("data-expand"),section=document.querySelector('.js-expand[data-expand="'+sectionId+'"]'),isOpen=hasClass(section,"is-active"),shouldClose=hasClass(section,"is-active");toggleActive(sections,section),isOpen&&shouldClose?removeClass(section,"is-active"):addClass(section,"is-active")})})},calcite.modal=function(domNode){function fenceModal(e){closest("js-modal",e.target)||modals.forEach(function(modal){hasClass(modal,"is-active")&&modal.focus()})}function escapeCloseModal(e){27===e.keyCode&&(modals.forEach(function(modal){removeClass(modal,"is-active"),modal.removeAttribute("tabindex")}),lastOn.focus(),toggleAriaHidden([wrapper,footer]),removeEvent(document,"keyup",escapeCloseModal),removeEvent(document,"focusin",fenceModal))}function bindModalToggle(e){preventDefault(e);var modal,toggle=e.target,modalId=toggle.getAttribute("data-modal");modal=modalId?document.querySelector('.js-modal[data-modal="'+modalId+'"]'):closest("js-modal",toggle);var isOpen=hasClass(modal,"is-active");toggleActive(modals,modal),toggleAriaHidden([wrapper,footer]),isOpen?(removeEvent(document,"keyup",escapeCloseModal),removeEvent(document,"focusin",fenceModal),lastOn.focus(),modal.removeAttribute("tabindex")):(addEvent(document,"keyup",escapeCloseModal),addEvent(document,"focusin",fenceModal),lastOn=toggle,modal.setAttribute("tabindex",0),modal.focus())}var lastOn,wrapper=document.querySelector(".wrapper"),footer=document.querySelector(".footer"),toggles=findElements(".js-modal-toggle",domNode),modals=findElements(".js-modal",domNode);toggles.forEach(function(toggle){addEvent(toggle,click(),bindModalToggle)})},calcite.tabs=function(domNode){function switchTab(e){preventDefault(e);var tab=closest("js-tab",eventTarget(e)),tabGroup=closest("js-tab-group",tab),tabs=tabGroup.querySelectorAll(".js-tab"),contents=tabGroup.querySelectorAll(".js-tab-section"),index=nodeListToArray(tabs).indexOf(tab);removeActive(tabs),removeActive(contents),nodeListToArray(tabs).forEach(function(t){t.setAttribute("aria-expanded",!1)}),nodeListToArray(contents).forEach(function(c){c.setAttribute("aria-expanded",!1)}),addClass(tab,"is-active"),addClass(contents[index],"is-active"),tab.setAttribute("aria-expanded","true"),contents[index].setAttribute("aria-expanded","true")}var tabs=findElements(".js-tab",domNode),tabGroups=findElements(".js-tab-group",domNode),tabSections=findElements(".js-tab-section",domNode);tabGroups.forEach(function(tab){tab.setAttribute("aria-live","polite"),tab.children[0].setAttribute("role","tablist");for(var tabsInGroup=tab.querySelectorAll(".js-tab"),percent=100/tabsInGroup.length,i=0;i<tabsInGroup.length;i++)tabsInGroup[i].style.maxWidth=percent+"%"}),tabs.forEach(function(tab){tab.setAttribute("aria-expanded","false"),tab.setAttribute("role","tab"),addEvent(tab,click(),switchTab),addEvent(tab,"keyup",function(e){13===e.keyCode&&switchTab(e)}),tab.setAttribute("tabindex","0")}),tabSections.forEach(function(section){section.setAttribute("role","tabpanel");var isOpen=hasClass(section,"is-active");isOpen?section.setAttribute("aria-expanded","true"):section.setAttribute("aria-expanded","false")})},calcite.siteSearch=function(domNode){function toggleForm(e){var searchContainer=closest("js-site-search",e.target),isOpen=hasClass(searchContainer,"is-active");isOpen?(removeClass(searchContainer,"is-active"),e.target.value=""):addClass(searchContainer,"is-active")}var searchForms=findElements(".js-site-search",domNode);searchForms.forEach(function(search){addEvent(search,"focusin",toggleForm),addEvent(search,"focusout",toggleForm)})},calcite.sticky=function(domNode){function scrollHandler(){stickies.forEach(function(item){var referenceElement=item.element;hasClass(item.element,"is-sticky")&&(referenceElement=item.shim);var dataTop=referenceElement.getAttribute("data-top")||0;item.top=referenceElement.offsetTop-parseInt(dataTop,0),item.top<window.pageYOffset?(addClass(item.element,"is-sticky"),item.shim.style.display=""):(removeClass(item.element,"is-sticky"),item.shim.style.display="none")})}var elements=findElements(".js-sticky",domNode),stickies=elements.map(function(el){var offset=el.offsetTop,dataTop=el.getAttribute("data-top")||0;el.style.top=dataTop+"px";var parent=el.parentNode,shim=el.cloneNode("deep");return shim.style.visibility="hidden",shim.style.display="none",parent.insertBefore(shim,el),{top:offset-parseInt(dataTop,0),shim:shim,element:el}});elements&&(calcite.addEvent(window,"scroll",throttle(scrollHandler,100)),calcite.addEvent(window,"resize",throttle(scrollHandler,100)),calcite.addEvent(document.body,"click",scrollHandler))},calcite.thirdNav=function(domNode){function scroll(distance){nav.scrollLeft+=distance}function resize(){calcite.removeClass(leftBtn,"is-active"),calcite.removeClass(rightBtn,"is-active"),nav.scrollLeft>0&&calcite.addClass(leftBtn,"is-active"),nav.scrollLeft+nav.clientWidth+5<nav.scrollWidth&&calcite.addClass(rightBtn,"is-active")}var nav=findElements(".js-nav-overflow",domNode)[0],leftBtn=findElements(".js-overflow-left",domNode)[0],rightBtn=findElements(".js-overflow-right",domNode)[0];nav&&(calcite.addEvent(leftBtn,calcite.click(),scroll.bind(null,-40)),calcite.addEvent(rightBtn,calcite.click(),scroll.bind(null,40)),calcite.addEvent(nav,"scroll",resize),calcite.addEvent(window,"resize",resize),resize())},"function"==typeof define&&define.amd)define(function(){return calcite});else if("object"==typeof exports)module.exports=calcite;else{var oldCalcite=window.calcite;calcite.noConflict=function(){return window.calcite=oldCalcite,this},window.calcite=calcite}}();